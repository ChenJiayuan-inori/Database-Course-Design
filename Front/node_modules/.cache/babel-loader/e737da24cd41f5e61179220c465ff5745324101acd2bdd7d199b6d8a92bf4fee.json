{"ast":null,"code":"import Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport { jwtDecode } from \"jwt-decode\";\nVue.use(VueRouter);\nconst routes = [{\n  path: '/login',\n  name: 'mytest',\n  component: () => import( /* webpackChunkName: \"about\" */'../views/MyTest.vue')\n}, {\n  path: '/',\n  name: 'index',\n  redirect: '/login'\n}, {\n  path: '/backpage',\n  name: 'backpage',\n  component: () => import('../views/BackPage.vue')\n}];\nconst router = new VueRouter({\n  routes\n});\n\n/*路由守卫   根据登录获得token*/\n\nrouter.beforeEach((to, from, next) => {\n  const isLogin = localStorage.Token ? true : false;\n  console.log(isLogin);\n  if (to.path === \"/login\" || to.path === \"/\") {\n    next();\n    return;\n  } else {\n    if (isLogin) {\n      try {\n        const token = jwtDecode(localStorage.getItem('Token'));\n        const expire = token.exp * 1000;\n        const now = new Date().getTime();\n        if (now > expire) {\n          // 如果令牌已过期，则删除localStorage中的token并重新登录或提示用户重新登录\n          localStorage.removeItem('Token');\n          alert('您的登录已过期，请重新登录。');\n          next('/login');\n        } else {\n          // 如果令牌未过期，则将token保存到localStorage中，并继续访问该路由\n          localStorage.setItem('Token', token);\n          next();\n        }\n      } catch (error) {\n        console.log(error);\n        next('/login');\n      }\n    } else {\n      next();\n    }\n  }\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","jwtDecode","use","routes","path","name","component","redirect","router","beforeEach","to","from","next","isLogin","localStorage","Token","console","log","token","getItem","expire","exp","now","Date","getTime","removeItem","alert","setItem","error"],"sources":["C:/Users/83407/Desktop/vue/vue-project/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport { jwtDecode } from \"jwt-decode\"\n\n\nVue.use(VueRouter)\n\nconst routes = [\n\t{\n\t\tpath: '/login',\n\t\tname: 'mytest',\n\t\tcomponent: () => import(/* webpackChunkName: \"about\" */ '../views/MyTest.vue')\n\t},\n\t{\n\t\tpath: '/',\n\t\tname: 'index',\n\t\tredirect: '/login'\n\t},\n\t{\n\t\tpath: '/backpage',\n\t\tname: 'backpage',\n\t\tcomponent: () => import('../views/BackPage.vue')\n\t},\n]\n\n\nconst router = new VueRouter({\n\troutes\n})\n\n/*路由守卫   根据登录获得token*/\n\nrouter.beforeEach((to,from,next) =>{\n\n  const isLogin = localStorage.Token ? true :false;\n  console.log(isLogin)\n\n\n\n  if(to.path ===\"/login\" || to.path === \"/\"){\n    next();\n    return;\n  }\n  else{\n    if(isLogin){\n      try{\n        const token = jwtDecode(localStorage.getItem('Token'));\n        const expire = token.exp * 1000;\n        const now = new Date().getTime();\n        if (now > expire) {\n          // 如果令牌已过期，则删除localStorage中的token并重新登录或提示用户重新登录\n          localStorage.removeItem('Token');\n          alert('您的登录已过期，请重新登录。');\n          next('/login');\n        } else {\n          // 如果令牌未过期，则将token保存到localStorage中，并继续访问该路由\n          localStorage.setItem('Token', token);\n          next();\n        } \n      }\n      catch (error) {\n        console.log(error);\n        next('/login');\n      }\n    }\n    else{\n      next();\n    }\n}});\n\n\nexport default router\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,SAAS,MAAM,YAAY;AAClC,SAASC,SAAS,QAAQ,YAAY;AAGtCF,GAAG,CAACG,GAAG,CAACF,SAAS,CAAC;AAElB,MAAMG,MAAM,GAAG,CACd;EACCC,IAAI,EAAE,QAAQ;EACdC,IAAI,EAAE,QAAQ;EACdC,SAAS,EAAEA,CAAA,KAAM,MAAM,EAAC,+BAAgC,qBAAqB;AAC9E,CAAC,EACD;EACCF,IAAI,EAAE,GAAG;EACTC,IAAI,EAAE,OAAO;EACbE,QAAQ,EAAE;AACX,CAAC,EACD;EACCH,IAAI,EAAE,WAAW;EACjBC,IAAI,EAAE,UAAU;EAChBC,SAAS,EAAEA,CAAA,KAAM,MAAM,CAAC,uBAAuB;AAChD,CAAC,CACD;AAGD,MAAME,MAAM,GAAG,IAAIR,SAAS,CAAC;EAC5BG;AACD,CAAC,CAAC;;AAEF;;AAEAK,MAAM,CAACC,UAAU,CAAC,CAACC,EAAE,EAACC,IAAI,EAACC,IAAI,KAAI;EAEjC,MAAMC,OAAO,GAAGC,YAAY,CAACC,KAAK,GAAG,IAAI,GAAE,KAAK;EAChDC,OAAO,CAACC,GAAG,CAACJ,OAAO,CAAC;EAIpB,IAAGH,EAAE,CAACN,IAAI,KAAI,QAAQ,IAAIM,EAAE,CAACN,IAAI,KAAK,GAAG,EAAC;IACxCQ,IAAI,CAAC,CAAC;IACN;EACF,CAAC,MACG;IACF,IAAGC,OAAO,EAAC;MACT,IAAG;QACD,MAAMK,KAAK,GAAGjB,SAAS,CAACa,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC,CAAC;QACtD,MAAMC,MAAM,GAAGF,KAAK,CAACG,GAAG,GAAG,IAAI;QAC/B,MAAMC,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;QAChC,IAAIF,GAAG,GAAGF,MAAM,EAAE;UAChB;UACAN,YAAY,CAACW,UAAU,CAAC,OAAO,CAAC;UAChCC,KAAK,CAAC,gBAAgB,CAAC;UACvBd,IAAI,CAAC,QAAQ,CAAC;QAChB,CAAC,MAAM;UACL;UACAE,YAAY,CAACa,OAAO,CAAC,OAAO,EAAET,KAAK,CAAC;UACpCN,IAAI,CAAC,CAAC;QACR;MACF,CAAC,CACD,OAAOgB,KAAK,EAAE;QACZZ,OAAO,CAACC,GAAG,CAACW,KAAK,CAAC;QAClBhB,IAAI,CAAC,QAAQ,CAAC;MAChB;IACF,CAAC,MACG;MACFA,IAAI,CAAC,CAAC;IACR;EACJ;AAAC,CAAC,CAAC;AAGH,eAAeJ,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}